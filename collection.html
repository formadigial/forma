<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Living Series | LuxeLiving Interiors</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600&family=Inter&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      background: #fdfdfd;
    }

    header {
      padding: 80px 20px 20px;
      text-align: center;
      background: #f8f6f1;
    }

    .section-title {
      font-family: 'Cormorant Garamond', serif;
      font-size: 2.2rem;
      margin-bottom: 10px;
    }

    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      padding: 40px 20px;
      max-width: 1200px;
      margin: auto;
    }

    .product-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.05);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: all 0.3s ease;
    }

    .product-card img {
      width: 100%;
      height: 220px;
      object-fit: cover;
    }

    .product-info {
      padding: 20px;
      flex-grow: 1;
    }

    .product-info h3 {
      font-family: 'Cormorant Garamond', serif;
      margin: 0 0 10px;
      font-size: 1.3rem;
    }

    .product-price {
      font-weight: bold;
      margin-top: 10px;
    }

    .buy-btn {
      background: #CBA135;
      color: white;
      padding: 10px;
      margin: 15px;
      text-align: center;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .buy-btn:hover {
      background: #a07f2a;
    }

    #formModal {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-content {
      background: white;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      border-radius: 10px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
    }

    .modal-close {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 24px;
      font-weight: bold;
      color: #999;
      cursor: pointer;
    }

    .modal-content input,
    .modal-content select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .payment-options {
      display: flex;
      flex-direction: column;
      margin-top: 10px;
      gap: 10px;
    }

    .payment-options label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
    }

    @media (max-width: 600px) {
      .modal-content {
        width: 95%;
        padding: 20px;
      }
    }


    .order-popup {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  padding: 14px 24px;
  border-radius: 8px;
  font-size: 15px;
  font-weight: 500;
  z-index: 2000;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 280px;
  max-width: 90%;
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
  transition: all 0.4s ease;
  opacity: 0;
  pointer-events: none;
}

.order-popup.show {
  opacity: 1;
  pointer-events: auto;
}

.order-popup.success {
  background-color: #e6f5ea;
  color: #2e7d32;
  border: 1px solid #a5d6a7;
}

.order-popup.error {
  background-color: #fdecea;
  color: #c62828;
  border: 1px solid #f44336;
}

.order-popup.warning {
  background-color: #fff8e1;
  color: #a67c00;
  border: 1px solid #fdd835;
}

.order-popup::after {
  content: '×';
  margin-left: 20px;
  cursor: pointer;
  font-size: 18px;
  line-height: 1;
}

.payment-options {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin-top: 15px;
}

.payment-card {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  border: 2px solid #ddd;
  border-radius: 10px;
  cursor: pointer;
  transition: border-color 0.3s ease, background 0.3s ease;
}

.payment-card:hover {
  background-color: #fef8e4;
  border-color: #cba135;
}

.payment-card input[type="radio"] {
  accent-color: #cba135;
  transform: scale(1.2);
  margin-right: 10px;
}

.card-body {
  display: flex;
  align-items: center;
  gap: 12px;
}

.card-body img {
  width: 32px;
  height: 32px;
}

.payment-card strong {
  font-size: 1rem;
  display: block;
  margin-bottom: 4px;
}

.payment-card p {
  font-size: 0.85rem;
  color: #666;
  margin: 0;
}



  </style>
</head>
<body>
<header>
  <h1 class="section-title">Rayyans Wood Park</h1>
  <p>Our Collection</p>
</header>

<div class="products-grid" id="productList"></div>

<div id="formModal">
  <div class="modal-content">
    <div class="modal-close" onclick="closeForm()">×</div>
    <h2>Enter Your Details</h2>
    <input type="text" id="custName" placeholder="Full Name" />
    <input type="email" id="custEmail" placeholder="Email" />
    <input type="text" id="custPhone" placeholder="Phone Number" />
    <select id="custState"></select>
    <select id="custDistrict"></select>
    <input type="text" id="custAddress" placeholder="Full Address" />
    <input type="text" id="custPin" placeholder="PIN Code" />
    <div id="formMessage" style="
  display: none;
  padding: 10px;
  border-radius: 6px;
  font-size: 14px;
  background: #fff8e1;
  color: #a67c00;
  border: 1px solid #fdd835;
  text-align: center;
"></div>

    <div class="payment-options">
  <label class="payment-card">
    <input type="radio" name="paymentMethod" value="upi" />
    <div class="card-body">
      <img src="https://img.icons8.com/color/48/upi.png" alt="UPI" />
      <div>
        <strong>Pay via UPI</strong>
        <p>Instant and secure online payment</p>
      </div>
    </div>
  </label>
  <label class="payment-card">
    <input type="radio" name="paymentMethod" value="cod" />
    <div class="card-body">
      <img src="https://img.icons8.com/ios-filled/50/000000/money.png" alt="Cash" />
      <div>
        <strong>Cash on Delivery</strong>
        <p>Pay when the product arrives</p>
      </div>
    </div>
  </label>
</div>

    <button class="buy-btn" onclick="submitOrder()">Place Order</button>
  </div>
</div>
<div id="orderMessage" style="display:none; margin-top:10px; padding:10px; font-size:0.9rem; border-radius:6px;"></div>
<div id="orderPopup" class="order-popup hidden"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
  import { getFirestore, addDoc, collection } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBGM4DkuRRLhL-RhXoNrgP2LUFQyNVCKDQ",
    authDomain: "test-a21c6.firebaseapp.com",
    projectId: "test-a21c6",
    storageBucket: "test-a21c6.appspot.com",
    messagingSenderId: "241202330354",
    appId: "1:241202330354:web:47a72aaf3232005b592e6b"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);
  emailjs.init("Hcvq6oNPEpYMaBg_J");



function showPopup(message, type = "success") {
  const popup = document.getElementById("orderPopup");
  popup.className = `order-popup ${type} show`;
  popup.innerHTML = `${message}<span onclick="hidePopup()" style="margin-left:20px; cursor:pointer;"></span>`;
  setTimeout(() => hidePopup(), 4000);
}

function hidePopup() {
  const popup = document.getElementById("orderPopup");
  popup.classList.remove("show");
}




  const stateDistricts = {
    "Karnataka": ["Bangalore", "Mysore", "Mangalore"],
    "Tamil Nadu": ["Chennai", "Coimbatore", "Madurai"],
    "Delhi": ["New Delhi", "Central Delhi"]
  };

  const stateSelect = document.getElementById("custState");
  const districtSelect = document.getElementById("custDistrict");

  function populateStates() {
    stateSelect.innerHTML = `<option value="">Select State</option>`;
    Object.keys(stateDistricts).forEach(state => {
      stateSelect.innerHTML += `<option value="${state}">${state}</option>`;
    });
  }

  function populateDistricts() {
    const selectedState = stateSelect.value;
    districtSelect.innerHTML = `<option value="">Select District</option>`;
    stateDistricts[selectedState]?.forEach(d => {
      districtSelect.innerHTML += `<option value="${d}">${d}</option>`;
    });
  }

  document.addEventListener("DOMContentLoaded", () => {
    populateStates();
    stateSelect.addEventListener("change", populateDistricts);
  });

  const products = [
    
  { name: "Modern Luxe Sofa", image: "https://images.unsplash.com/photo-1582582423086-d788f0c622c5", price: 34999 },
  { name: "Elegant Coffee Table", image: "https://images.unsplash.com/photo-1615874959474-df130d7eb4d9", price: 19999 },
  { name: "Contemporary Lounge Chair", image: "https://images.unsplash.com/photo-1549187774-b4e9b0445b05", price: 17999 },
  { name: "Handcrafted Bookshelf", image: "https://images.unsplash.com/photo-1616628182509-63019f3b3c84", price: 21999 },
  { name: "Luxury Recliner Set", image: "https://images.unsplash.com/photo-1615873968403-0e26b9e9d718", price: 28999 },
  { name: "Wooden TV Stand", image: "https://images.unsplash.com/photo-1600585153961-3b6b68c99c91", price: 16999 },
  { name: "Classic Ottoman", image: "https://images.unsplash.com/photo-1616627571753-7db9b90dc442", price: 1 },
  { name: "Velvet Sectional", image: "https://images.unsplash.com/photo-1606813909361-63fbdac2cf4e", price: 41999 },
  { name: "Vintage Side Cabinet", image: "https://images.unsplash.com/photo-1600585154340-be6161a56a0c", price: 18999 },
  { name: "Minimalist Floor Lamp", image: "https://images.unsplash.com/photo-1616628182509-63019f3b3c84", price: 7499 }


  ];

  let selectedProduct = null;
  let currentUser = null;

  onAuthStateChanged(auth, user => {
    currentUser = user;
  });

  function renderProducts() {
    const list = document.getElementById("productList");
    list.innerHTML = "";
    products.forEach((product, index) => {
      list.innerHTML += `
        <div class="product-card">
          <img src="${product.image}" alt="${product.name}">
          <div class="product-info">
            <h3>${product.name}</h3>
            <p>Crafted with precision and elegance.</p>
            <div class="product-price">₹${product.price.toLocaleString()}</div>
          </div>
          <button class="buy-btn" onclick="openForm(${index})">Buy Now</button>
        </div>
      `;
    });
  }

  renderProducts();

  window.openForm = (index) => {
    if (!currentUser) {
      window.location.href = "login.html";
      return;
    }
    selectedProduct = products[index];
    document.getElementById("formModal").style.display = "flex";
  };

  window.closeForm = () => {
    document.getElementById("formModal").style.display = "none";
  };

  window.submitOrder = async () => {
    const name = document.getElementById("custName").value;
    const email = document.getElementById("custEmail").value;
    const phone = document.getElementById("custPhone").value;
    const state = document.getElementById("custState").value;
    const district = document.getElementById("custDistrict").value;
    const address = document.getElementById("custAddress").value;
    const pin = document.getElementById("custPin").value;
    const method = document.querySelector('input[name="paymentMethod"]:checked');

   const formMsg = document.getElementById("formMessage");
if (!name || !email || !phone || !address || !pin || !state || !district || !method) {
  formMsg.innerText = "⚠️ Please fill in all fields before placing your order.";
  formMsg.style.display = "block";
  return;
} else {
  formMsg.style.display = "none"; // hide if previously shown
}
formMsg.innerText = "⚠️ Please fill in all fields before placing your order.";
formMsg.style.display = "block";
setTimeout(() => { formMsg.style.display = "none"; }, 4000);


    const now = Date.now();
    const delivery = now + 5 * 24 * 60 * 60 * 1000;

    const fullOrder = {
      userId: currentUser.uid,
      name, email, phone, state, district, address, pin,
      product: selectedProduct.name,
      productImage: selectedProduct.image,
      price: selectedProduct.price,
      productCategory: "Living Series",
      payment: method.value.toUpperCase(),
      payment_id: "COD",
      createdAt: now,
      deliveryDate: delivery,
      status: "Pending"
    };

 const handleSuccess = async (payment_id) => {
  fullOrder.payment_id = payment_id;
  try {
    await emailjs.send("service_5d7cdhp", "template_vhspbdj", fullOrder);
    await addDoc(collection(db, "orders"), fullOrder);
    showPopup("✅ Order placed successfully!", "success");
    closeForm();
  } catch (e) {
    console.error("Error saving order: ", e);
    showPopup("❌ Order failed. Please try again.", "error");
  }
};

    if (method.value === "upi") {
      const rzp = new Razorpay({
        key: 'rzp_live_LsOtu3jPLnqjXr',
        amount: selectedProduct.price * 100,
        currency: "INR",
        name: "LuxeLiving",
        description: selectedProduct.name,
        handler: function (response) {
          handleSuccess(response.razorpay_payment_id);
        },
        prefill: { name, email, contact: phone },
        theme: { color: "#CBA135" }
      });
      rzp.open();
    } else {
      handleSuccess("COD");
    }
  };
</script>
</body>
</html>
